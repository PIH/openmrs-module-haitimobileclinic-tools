<htmlform>
<!-- Full reference for HTML Forms at http://wiki.openmrs.org/x/kg8z -->
	<macros>
		paperFormId = (Fill this in)
		headerColor =#009d8e
		fontOnHeaderColor = white
	</macros>

	<style>
		.section {
			border: 1px solid $headerColor;
			padding: 2px;
			text-align: left;
			margin-bottom: 1em;
		}
		.sectionHeader {
			background-color: $headerColor;
			color: $fontOnHeaderColor;
			display: block;
			padding: 2px;
			font-weight: bold;
		}
		table.baseline-aligned td {
			vertical-align: baseline;
		}
	</style>

	<script type="text/javascript">
		function getSessionDate() {
		   return "<lookup expression="session.httpSession.getAttribute('sessionDate')" />";
		}
		function getSessionCoordinates() {
		   return "<lookup expression="session.httpSession.getAttribute('sessionCoordinates')" />";
		}
		function getSessionChwName1() {
		   return "<lookup expression="session.httpSession.getAttribute('sessionChwName1')" />";
		}
		function getSessionChwName2() {
		   return "<lookup expression="session.httpSession.getAttribute('sessionChwName2')" />";
		}
		function getSessionChwName3() {
		   return "<lookup expression="session.httpSession.getAttribute('sessionChwName3')" />";
		}
		function getSessionNecName() {
		   return "<lookup expression="session.httpSession.getAttribute('sessionNecName')" />";
		}
		function getSessionLocation() {
		   return "<lookup expression="session.httpSession.getAttribute('sessionLocation')" />";
		}
		
		$j(function() {
			<includeIf velocityTest="$context.getMode()=='ENTER' ">
				setValue('sessionLocation.value', getSessionLocation());
				setValue('sessionCoordinates.value', getSessionCoordinates());
				setValue('sessionNecName.value', getSessionNecName());
				setValue('sessionChwName1.value', getSessionChwName1());
				setValue('sessionChwName2.value', getSessionChwName2());
				setValue('sessionChwName3.value', getSessionChwName3());
				setValue('encounterDate.value', getSessionDate());
			</includeIf> 
		});
		
		$j(document).ready(function(){
			$j('#sessionChwName1 input').attr('readonly', 'true');
			$j('#sessionChwName2 input').attr('readonly', 'true');
			$j('#sessionChwName3 input').attr('readonly', 'true');
			$j('#sessionNecName input').attr('readonly', 'true');
			$j('#sessionLocation input').attr('readonly', 'true');
			$j('#sessionCoordinates input').attr('readonly', true);
//			$j('#encounterDate input').attr('readonly', 'true');
//			$j('#encounterLocation select').attr('readonly', 'true');
		});
	</script>

	<span style="float:right">v1.0 (14-JANUARY 2013)</span>

	<h2>Mobile Clinic Consultation Form</h2>

	<section headerLabel="Patient Demographics (readonly, change here)">
		<table class="baseline-aligned">
			<tr>
				<td>ZL EMR ID:</td>
				<td>
					<lookup class="value"
						complexExpression="#foreach( $patId in $patientIdentifiers.get('ZL EMR ID') ) $patId #end " />
				</td>
				<td>Dossier Number:</td>
				<td>
					<lookup class="value"
						complexExpression="#foreach( $patId in $patientIdentifiers.get('Nimewo Dosye') ) $patId #end " />
				</td>
			</tr>
			<tr>
				<td>Name:</td>
				<td>
					<lookup class="value" expression="patient.personName" />
				</td>
			</tr>
			<tr>
				<td>Lokalitie:</td>
				<td></td>
			</tr>
			<tr>
				<td>Gender:</td>
				<td>
					<lookup class="value" expression="patient.gender" />
				</td>
			</tr>
		</table>
	</section>


	<section headerLabel="Visit Details (readonly, change here)">
		<table class="baseline-aligned">
			<tr>
				<td>Date:</td>
				<td>
					<encounterDate id="encounterDate"/>
				</td>
				<td>Location:</td>
				<td colspan="5">
					<encounterLocation id="encounterLocation"/>
					(Use <a href="/openmrs/options.form">'My Profile' - 'Default location'</a> to change default location)
				</td>
			</tr>
			<tr>
				<td>Clinic location:</td>
				<td><obs conceptId="6767" id="sessionLocation" /></td>
				<td>GPS coordinates :</td>
				<td><obs conceptId="6772" id="sessionCoordinates"/></td>
			</tr>
			<tr>
				<td>NEC name:</td>
				<td><obs conceptId="6769" id="sessionNecName"/></td>
				<td>CHW name 1:</td>
				<td><obs conceptId="6768" id="sessionChwName1"/></td>
				<td>CHW name 2:</td>
				<td><obs conceptId="6770" id="sessionChwName2"/></td>
				<td>CHW name 3:</td>
				<td><obs conceptId="6771" id="sessionChwName3"/></td>
			</tr>
		</table>
	</section>

	<section headerLabel="Clinical Impression">
		<table class="baseline-aligned">
			<tr>
				<td>Pregnant (only female):</td>
				<td><obs conceptId="6744" style="radio"/></td>
			</tr>
			<tr>
				<td>Diagnosis</td>
				<td>Coded:</td>
				<td><obs conceptId="6542" /></td>
				<td>Uncoded:</td>
				<td><obs conceptId="6543" /></td>
			</tr>
			<tr>
				<td/>
				<td/>
				<td><obs conceptId="6542" /></td>
				<td/>
				<td><obs conceptId="6543" /></td>
			</tr>
			<tr>
				<td/>
				<td/>
				<td><obs conceptId="6542" /></td>
				<td/>
				<td><obs conceptId="6543" /></td>
			</tr>
			<tr>
				<td>Provider:</td>
				<td colspan="2">
					<encounterProvider />
				</td>
			</tr>
		</table>
	</section>

	<section headerLabel="Depistage TB">
		<table class="baseline-aligned">
			<tr>
				<td><obs conceptId="6744" labelNameTag="default" style="radio"/></td>
			</tr>
			<tr>
				<td><obs conceptId="6745" labelNameTag="default" style="radio"/></td>
			</tr>
			<tr>
				<td><obs conceptId="6746" labelNameTag="default" style="radio"/></td>
			</tr>
			<tr>
				<td><obs conceptId="6747" labelNameTag="default" style="radio"/></td>
			</tr>
			<tr>
				<td><obs conceptId="6748" labelNameTag="default" style="radio"/></td>
			</tr>
		</table>
	</section>

	<section headerLabel="Depistage VIH">
		<table class="baseline-aligned">
			<tr>
				<td>HIV Test:</td>
				<td><obs conceptId="6762" style="radio"/></td>
			</tr>
			<tr>
				<td>Result, if tested:</td>
				<td><obs conceptId="3753" style="radio"/></td>
			</tr>
		</table>
	</section>

	<section headerLabel="Supplemental questions">
		<table class="baseline-aligned">
			<tr>
				<td><obs conceptId="6749" labelNameTag="default" style="radio"/></td>
			</tr>
			<tr>
				<td><obs conceptId="6766" labelNameTag="default" style="radio"/> (for children under age 6)</td>
			</tr>
		</table>
	</section>

	<section headerLabel="Referral">
		<table class="baseline-aligned">
			<tr>
				<td><obs conceptId="6750" labelNameTag="default" style="radio"/></td>
			</tr>
			<tr>
				<td><obs conceptId="6760" labelNameTag="default" style="radio"/></td>
			</tr>
		</table>
	</section>

	<submit />
</htmlform>